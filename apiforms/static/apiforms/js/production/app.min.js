/*! imentor-apiforms - v0.0.1 - 2016-12-14 */var logger=angular.module("loggerServices",[]);logger.value("log",{id:void 0,enabled:!1,data:{}}),logger.service("jsonLogger",["$q","$http","log",function(a,b,c){function d(){var a=function(){function a(){return Math.random().toString(16).slice(-4)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},d={};d.metaData={},this.createNewID=function(){return d.log_transaction_id=a(),d.log_transaction_id},this.getID=function(){return d.log_transaction_id},this.enable=function(){c.enabled=!0},this.disable=function(){c.enabled=!1},this.setMetaData=function(a){return d.metaData=a},this.getMetaData=function(){return d.metaData},this.setLoggerData=function(a){return c.data=a},this.getLoggerData=function(){return c.data},this.log=function(e){c.enabled===!0&&(angular.isDefined(c.id)===!1&&(c.id=a()),angular.isDefined(d.log_transaction_id)===!1&&(d.log_transaction_id=a()),d.logger=c,d.payload=e,b({method:"POST",url:"/generic/json_logger/",data:JSON.stringify(angular.toJson(d))}).then(function(a,b,c,d){},function(a){}))}}return d}]);;
var services=angular.module("formsServices",["ngResource","loggerServices"]);services.factory("Form",["$http","$rootScope",function(a,b){var c="/forms/form/",d="/forms/form_gen/";return{list:function(b,c){return"undefined"==typeof c?a.get(d+b+"/",{}):a.get(d+b+"/"+c+"/",{})},save:function(d,e,f,g){return"undefined"!=typeof b.globalUser?a.post(c+d+"/section/"+e+"/question/"+f+"/user_response/"+b.globalUser+"/",g):a.post(c+d+"/section/"+e+"/question/"+f+"/user_response/",g)},"delete":function(d,e,f){return"undefined"!=typeof b.globalUser?a["delete"](c+d+"/section/"+e+"/question/"+f+"/user_response/"+b.globalUser+"/"):a["delete"](c+d+"/section/"+e+"/question/"+f+"/user_response/")}}}]).factory("Lookup",["$resource",function(a){return a("/forms_data/form_lookup/",{},{query:{method:"GET",params:{}}})}]).factory("Question",["$resource",function(a){return a("/forms/form/:formId/section/:sectionId/question/:questionId/user_response/",{},{save:{method:"POST",params:{formId:"@form_id",sectionId:"@section_id",questionId:"@question_id"}}})}]).factory("College",["$resource",function(a){return a("/forms_data/colleges/:filter/",{filter:"@filter"},{})}]).factory("Employer",["$resource",function(a){return a("/forms_data/employers/:filter/",{filter:"@filter"},{})}]).factory("School",["$resource",function(a){return a("/forms_data/schools/:userId/",{},{query:{method:"GET",params:{},userId:"@user_id"}})}]).factory("Career",["$resource",function(a){return a("/forms_data/careers/",{},{query:{method:"GET",params:{},isArray:!0}})}]).factory("CareerOnly",["$resource",function(a){return a("/forms_data/careers_only/",{},{query:{method:"GET",params:{},isArray:!0}})}]).factory("Country",["$resource",function(a){return a("/forms_data/countries/",{},{query:{method:"GET",params:{},isArray:!0}})}]).factory("State",["$resource",function(a){return a("/forms_data/states/",{},{query:{method:"GET",params:{},isArray:!0}})}]).factory("Racial",["$resource",function(a){return a("/forms_data/rgroups/",{},{query:{method:"GET",params:{},isArray:!0}})}]).factory("Academic",["$resource",function(a){return a("/forms_data/afields/",{},{query:{method:"GET",params:{},isArray:!0}})}]).factory("Program",["$resource",function(a){return a("/forms_data/mprograms/:userId/",{},{query:{method:"GET",params:{},isArray:!0,userId:"@user_id"}})}]).factory("Login",["$http",function(a){var b="/iuser/ajax_login/",c=Object;return c.login=function(c){return a.post(b,c)},c}]).factory("ResetPassword",["$http",function(a){var b="/password/ajax_reset_request/",c=Object;return c.reset=function(c){return a.post(b,{email:c})},c}]).factory("Signup",["$http",function(a){var b="/iuser/ajax_createuser/",c=Object;return c.signup=function(c){return a.post(b,c)},c}]).service("appFunc",["$q","Form","jsonLogger",function(a,b,c){var d={};return{hideQuestions:function(a){angular.forEach(d.section.questions,function(b,c){-1!==a.indexOf(b.id)?(b.is_visible=!1,b.required=!1):!1===b.is_visible&&(b.is_visible=!0,b.updateRequired&&b.updateRequired())})},setSection:function(a){d.section=a},getSection:function(){return d.section},updateUserResponse:function(e,f,g,h){var i=new c;i.setMetaData({caller:"appFunc.updateUserResponse"}),i.log({status:"Update user response initiated",params:{form_id:d.section.form_id,section_id:d.section.id,question_id:e.id,data:f}});var j=a.defer(),k=this;return e.onBackendCall===!0?(g.error="already in progress",i.log({status:"Update user response cancelled due to previous save in progress",api:"/forms/form/",params:{form_id:d.section.form_id,section_id:d.section.id,question_id:e.id,data:f}}),j.reject("already progress"),j.promise):(f.payload={is_visible:e.is_visible,is_required:e.is_required,required:e.required,is_active:e.is_active,parent_id:e.parent_id,user_id:e.user_id,dependent_on_question_id:e.dependent_on_question_id,question_section_id:e.section_id,section_id:d.section.id},e.onBackendCall=!0,i.log({status:"Calling",api:"/forms/form/",params:{form_id:d.section.form_id,section_id:d.section.id,question_id:e.id,data:f}}),b.save(d.section.form_id,d.section.id,e.id,f).success(function(a){e.onBackendCall=!1,1==a.success?(g.error="",k.hideQuestions(a.hide),e.hasSaveError=!1,i.log({status:"Success",response:a,api:"/forms/form/",params:{form_id:d.section.form_id,section_id:d.section.id,question_id:e.id,data:f}})):(g.error=a.error,e.hasSaveError=!0,i.log({status:"Error",response:a,api:"/forms/form/",params:{form_id:d.section.form_id,section_id:d.section.id,question_id:e.id,data:f}})),j.resolve(a)}).error(function(a){console.log(a),e.onBackendCall=!1,g.error="Answer did not save. Refresh and try again",e.required=!0,e.hasSaveError=!0,i.log({status:"Error",response:a,api:"/forms/form/",params:{form_id:d.section.form_id,section_id:d.section.id,question_id:e.id,data:f}}),h&&_.each(h,function(a){a.selected=!1}),j.reject(a)}),j.promise)},deleteUserResponse:function(e,f,g){var h=new c;h.setMetaData({caller:"appFunc.deleteUserResponse"}),h.log({status:"Delete user response initiated",params:{form_id:d.section.form_id,section_id:d.section.id,question_id:e.id}});var i=a.defer();return e.onBackendCall===!0?(f.error="already in progress",h.log({status:"Delete user response cancelled due to previous delete in progress",api:"Form.delete",params:{form_id:d.section.form_id,section_id:d.section.id,question_id:e.id}}),i.reject("already progress"),i.promise):(e.onBackendCall=!0,h.log({status:"Calling",api:"/forms/form/",params:{form_id:d.section.form_id,section_id:d.section.id,question_id:e.id}}),b["delete"](d.section.form_id,d.section.id,e.id).success(function(a){e.onBackendCall=!1,1==a.success?(f.error="",e.hasSaveError=!1,h.log({status:"Success",response:a,api:"/forms/form/",params:{form_id:d.section.form_id,section_id:d.section.id,question_id:e.id}})):(f.error=a.error,e.hasSaveError=!0,h.log({status:"Error",response:a,api:"/forms/form/",params:{form_id:d.section.form_id,section_id:d.section.id,question_id:e.id}})),i.resolve(a)}).error(function(a){console.log(a),e.onBackendCall=!1,f.error="Answer did not save. Refresh and try again",e.required=!0,e.hasSaveError=!0,h.log({status:"Error",response:a,api:"/forms/form/",params:{form_id:d.section.form_id,section_id:d.section.id,question_id:e.id}}),g&&_.each(g,function(a){a.selected=!1}),i.reject(a)}),i.promise)}}}]);;
var forms=angular.module("imForm",["formsServices","ui.bootstrap","ngCookies","duScroll","ngHamburger","loggerServices"]);forms.config(["$interpolateProvider","$resourceProvider",function(a,b){b.defaults.stripTrailingSlashes=!1,a.startSymbol("[["),a.endSymbol("]]")}]),forms.config(["$sceDelegateProvider",function(a){a.resourceUrlWhitelist(["self","https://cdn.imentor.org/**"])}]),forms.run(["$rootScope",function(a){a.globalUser=""}]),forms.controller("componentsCtrl",["$scope","$q","$http","$location","$window","$document","$timeout","$rootScope","$document","Form","School","Career","CareerOnly","Country","State","Racial","Academic","Program","appFunc","Lookup","jsonLogger",function(a,b,c,d,e,f,g,h,f,i,j,k,l,m,n,o,p,q,r,s,t){var u=new t;a.init=function(d){function e(){return c({method:"GET",url:"/generic/user_info/"}).then(function(a){var b=u.getLoggerData();return"undefined"!=typeof b.login_user_id&&""!==b.login_user_id.toString().trim()&&0!==b.login_user_id.length||(b.login_user_id=a.data.self.user_id,u.setLoggerData(b)),a.data})}function s(){u.log({status:"Getting form for user"});var b=null;return"undefined"!=typeof d?(u.setMetaData({caller:"componentsCtrl.getlookup"}),u.log({status:"Calling",api:"/forms_data/form_lookup/"+d+"/"}),b=c.get("/forms_data/form_lookup/"+d+"/",{})):(u.setMetaData({caller:"componentsCtrl.getlookup"}),u.log({status:"Calling",api:"/forms_data/form_lookup/"}),b=c.get("/forms_data/form_lookup/",{})),b.then(function(b){a.formId=b.data,u.setMetaData({caller:"componentsCtrl.getlookup"}),u.log({status:"Success",response:b});var c=u.getLoggerData();c.form_id=a.formId,u.setLoggerData(c)})}function t(){return m.query({}).$promise.then(function(b){a.countries=b})}function v(){return n.query({}).$promise.then(function(b){a.states=b})}function w(){return j.query({userId:d}).$promise.then(function(b){a.schools=b})}function x(){return k.query({}).$promise.then(function(b){a.careers=b})}function y(){return l.query({}).$promise.then(function(b){a.careers_only=b})}function z(){return o.query({}).$promise.then(function(b){a.racials=b})}function A(){return p.query({}).$promise.then(function(b){a.academics=b})}function B(){return q.query({userId:d}).$promise.then(function(b){a.programs=b})}a.buttonText="Submit",a.nextButtonText="Next",a.busySubmit=!1,console.log("the var: "+d),h.globalUser=d,a.fieldErrMsg="Required",h.busy=!0,console.log("user_id: "+a.user_id);var C=u.getLoggerData();C.form_user_id=a.user_id||d||"",u.setLoggerData(C),e().then(function(){return b.all([s(),t(),v(),w(),x(),y(),z(),A(),B()])}).then(function(b){return u.setMetaData({caller:"componentsCtrl.init"}),u.log({status:"Calling",api:"Form.list",api_data:{form_id:a.formId,user_id:d}}),i.list(a.formId,d)}).then(function(b){u.log({status:"Success",response:b}),a.form=b.data.form,a.section=null,h.busy=!1,angular.forEach(b.data.form.sections,function(b,c){1==b.ordinal&&(a.section=b,r.setSection(a.section))}),null===a.section&&b.data.form.sections.length>0&&(a.section=b.data.form.sections[0],r.setSection(a.section)),a.sectionId=a.section.id,a.description=b.data.form.description,a.sections=a.form.sections,a.isNext=!0,h.formSaving="Just saved.",a.reportClick=function(){h.formSaving="Saving...",g(function(){h.formSaving="Just saved."},1e3)},a.goToNextSectionCounter=0,a.goToNextSection=function(b,c){angular.isDefined(c)?a.goToNextSectionCounter=a.goToNextSectionCounter+1:a.goToNextSectionCounter=0,u.createNewID();var d=u.getMetaData();d.caller="AppSubmittedController.goToNextSection",u.setMetaData(d),u.log({status:"Checking for unanswered questions",section:a.section});var e=a.form.sections.length,h=a.form.sections.indexOf(b)+1,i=30,j=2e3;a.nextButtonText="Next";for(var k=0;k<a.section.questions.length;k++){var l=a.section.questions[k],m=null;m=17==l.question_type?angular.element(document.querySelector("#q"+l.id+" .occupation")):angular.element(document.querySelector("#q"+l.id));var n;if(m||m.length>=0){var o=angular.element($($(m.find("div")[0]).find("div")[0]).find("div")[0]);n=angular.element(o).scope()}if(!0===l.is_visible&&(!0===l.required||!0===l.onBackendCall||angular.isDefined(l.hasSaveError)&&l.hasSaveError===!0))return!0===l.onBackendCall?g(function(){u.log({status:"One of question is updating now. Will retry in one second",question:l}),a.goToNextSectionCounter<3&&a.goToNextSection(b,a.goToNextSectionCounter)},1e3):angular.isDefined(l.hasSaveError)&&l.hasSaveError===!0?(u.log({status:"One of question had error. Saving it. Cancelling move to next section.",question:l}),n.update(),g(function(){u.log({status:"One of question is updating now. Will retry in one second",question:l}),a.goToNextSectionCounter<3&&a.goToNextSection(b,a.goToNextSectionCounter)},1e3)):(l.edited=!0,(m||m.length>=0)&&(l.showRequired=!0,f.scrollToElement(m,i,j)),u.log({status:"One of question is unanswered. Cancelling move to next section.",question:l})),!1}if(e>h){u.log({status:"Checking if previous section has completed all answers."});var p=!1;if(h>1)for(var q=a.form.sections[h-2],k=0;k<q.questions.length;k++){var l=q.questions[k];if(!0===l.is_visible&&(!0===l.required||!0===l.onBackendCall)){u.log({status:"One of question in section is unanswered. Moving to that section.",question:l,prevSection:q}),p=!0;break}}console.log("isNext: "+a.isNext);var s=h,t=h+1;p===!0?t=h-1:u.log({status:"No question in section is unanswered. Moving to that section.",section:a.form.sections[t-1]}),angular.element("#"+t).removeClass("disabled").addClass("active"),angular.element("#"+s).removeClass("active").addClass("past"),a.section=a.form.sections[t-1],r.setSection(a.section);var v=angular.element(document.querySelector("#headerCtrl")).scope();v.theTab=t;var w=angular.element(document.querySelector("#header"));f.scrollToElement(w);var x=angular.element("#default");x.focus()}return h>=e-1&&(a.isNext=!1),a.isNext}})["catch"](function(a){console.log("Error occured: "+a),u.log({status:"Error",response:a})})},a.logout=function(){u.createNewID();var a=u.getMetaData();a.caller="AppSubmittedController.logout",u.setMetaData(a);var b=d.host(),c="//"+b+"/iuser/logout/";u.log({url:c}),setTimeout(function(){e.location.href=c},500)},a.exportApplication=function(a){u.createNewID();var b=u.getMetaData();b.caller="AppSubmittedController.exportApplication",u.setMetaData(b),u.log({status:"Calling",api:"/forms_data/export/"+a+"/"}),c({method:"GET",url:"/forms_data/export/"+a+"/"}).success(function(a,b,c,d){u.log({status:"Success",response:a});var e=angular.element('<div data-tap-disabled="true"><a></a></div>'),h=angular.element(e.children()[0]);h.attr("href","data:text/csv;charset=utf-8,"+encodeURI(a)),h.attr("download","application_export.csv"),h.attr("target","_blank"),f.find("body").append(e),g(function(){h[0].click(),h.remove()},null)}).error(function(a,b,c,d){u.log({status:"Error",response:a})})},a.getQuestionView=function(a){var b=a.question_type,c="";switch(b){case 1:c='<div class="freeFormTextArea" id="freeTextA_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 1" question="question"  field-err-msg="fieldErrMsg"> </div>';break;case 2:c='<div class="freeFormTextBox" id="freeTextB_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 2" question="question" field-err-msg="fieldErrMsg"> </div>';break;case 3:c='<div class="phone-box" id="phone_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 3" question="question"  field-err-msg="fieldErrMsg"> </div>';break;case 4:c='<div class="address" id="address_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 4" question="question" states="states" field-err-msg="fieldErrMsg"> </div>';break;case 5:c='<div class="select-toggle" id="toggle_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 5" question="question" field-err-msg="fieldErrMsg"></div>';break;case 6:c='<div class="single-select-radio" id="radio_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 6" question="question" field-err-msg="fieldErrMsg"></div>';break;case 7:c='<div class="multi-select" id="multi_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 7" question="question" field-err-msg="fieldErrMsg"></div>';break;case 8:c='<div class="dropdown" id="dropdown_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 8" question="question" field-err-msg="fieldErrMsg"></div>';break;case 9:c='<div class="dropdown-country" id="country_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 9" question="question" countries="countries" field-err-msg="fieldErrMsg"></div>';break;case 10:c='<div class="dropdown-state" id="state_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 10" question="question" states="states" field-err-msg="fieldErrMsg"></div>';break;case 11:c='<div class="dropdown-employer" id="employer_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 11" question="question" field-err-msg="fieldErrMsg"></div>';break;case 12:c='<div class="dropdown-college" id="college_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 12" question="question" field-err-msg="fieldErrMsg"></div>';break;case 13:c='<div class="dropdown-school" id="school_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 13" question="question" schools="schools" field-err-msg="fieldErrMsg"></div>';break;case 14:c='<div class="datetime" id="datetime_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 14 " question="question" field-err-msg="fieldErrMsg"></div>';break;case 15:c='<div class="heading" id="heading_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 15 " question="question" field-err-msg="fieldErrMsg"></div>';break;case 16:c='<div class="instruction" id="instruction_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 16 " question="question" field-err-msg="fieldErrMsg"></div>';break;case 17:c='<div class="career_occupation" id="careerO-_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 17 " question="question" careers="careers" field-err-msg="fieldErrMsg"></div>';break;case 18:c='<div class="career" id="career_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 18 " question="question" careers-only="careers_only" field-err-msg="fieldErrMsg"></div>';break;case 19:c='<div class="racial" id="race_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 19 " question="question" racials="racials" field-err-msg="fieldErrMsg"></div>';break;case 20:c='<div class="academic" id="academic_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 20 " question="question" academics="academics" field-err-msg="fieldErrMsg"></div>';break;case 21:c='<div class="program" id="program_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 21 " question="question" programs="programs" field-err-msg="fieldErrMsg"></div>';break;case 22:c='<div class="noprefToggle" id="nopref_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 22 " question="question" field-err-msg="fieldErrMsg"></div>';break;case 23:c='<div class="dropdown-dependence" id="employer_[[::question.ordinal]]_[[::question.sub_ordinal]]" ng-if="question.question_type == 23" question="question" field-err-msg="fieldErrMsg"></div>'}return c}}]),forms.controller("saveBtnController",["$scope","$timeout","$http","$window","Form","appFunc","$document","jsonLogger",function(a,b,c,d,e,f,g,h){var i=new h;a.showMsg=!1,a.showSaveMsg=function(){var c=!1,d=2e3;a.theMsg="Your progress has been saved!",c&&b.cancel(c),a.showMsg=!0,a.msgTimer=b(function(){a.showMsg=!1},d)},a.submitApplicationCounter=0,a.submitApplication=function(e,h,j){angular.isDefined(j)?a.submitApplicationCounter=a.submitApplicationCounter+1:a.submitApplicationCounter=0;var k=30,l=2e3;a.busySubmit=!0,a.buttonText="Submitting...",i.createNewID();var m=i.getMetaData();m.caller="saveBtnController.submitApplication",i.setMetaData(m);var n=f.getSection();i.log({status:"Submit called",from_section:n}),i.log({status:"Checking for unanswered questions",section:a.section});for(var o=0;o<a.section.questions.length;o++){var p=a.section.questions[o],q=null;q=17==p.question_type?angular.element(document.querySelector("#q"+p.id+" .occupation")):angular.element(document.querySelector("#q"+p.id));var r;if(q||q.length>=0){var s=angular.element($($(q.find("div")[0]).find("div")[0]).find("div")[0]);r=angular.element(s).scope()}if(!0===p.is_visible&&(!0===p.required||!0===p.onBackendCall||angular.isDefined(p.hasSaveError)&&p.hasSaveError===!0))return!0===p.onBackendCall?b(function(){i.log({status:"One of question is updating now. Will retry in one second",question:p}),a.submitApplicationCounter<3&&a.submitApplication(e,h,a.submitApplicationCounter)},1e3):angular.isDefined(p.hasSaveError)&&p.hasSaveError===!0?(i.log({status:"One of question had error. Saving it. Cancelling move to next section.",question:p}),r.update(),b(function(){i.log({status:"One of question is updating now. Will retry in one second",question:p}),a.submitApplicationCounter<3&&a.submitApplication(e,h,a.submitApplicationCounter)},1e3)):(p.edited=!0,(q||q.length>=0)&&(p.showRequired=!0,g.scrollToElement(q,k,l)),a.busySubmit=!1,a.buttonText="Submit",i.log({status:"One of question is unanswered. Cancelling move to next section.",question:p})),!1}var t=angular.element(document.querySelector(".question-section:not(.ng-hide) .ng-valid-parse.ng-invalid.ng-invalid-required.ng-touched")),u=angular.element(document.querySelector(".question-section:not(.ng-hide) .question-ptext.ng-pristine.ng-untouched.ng-invalid.ng-invalid-required"));if("undefined"!=typeof t[0])g.scrollToElement(t[0],k,l),a.busySubmit=!1,a.buttonText="Submit";else if("undefined"!=typeof u[0])g.scrollToElement(u[0],k,l),a.busySubmit=!1,a.buttonText="Submit";else{if(i.log({status:"Checking if previous sections has completed all answers.",sections:a.form.sections}),a.form.sections.length>1)for(var v=a.form.sections.length,w=a.form.sections[v-2],o=0;o<w.questions.length;o++){i.log({status:"Checking if previous section has completed all answers.",section:w});var p=w.questions[o];if(!0===p.is_visible&&(!0===p.required||!0===p.onBackendCall)){var x=v,y=v-1;angular.element("#"+y).removeClass("disabled").addClass("active"),angular.element("#"+x).removeClass("active").addClass("past"),a.$parent.section=a.$parent.form.sections[y-1],f.setSection(a.$parent.section),a.$parent.isNext=!0,a.busySubmit=!1,a.buttonText="Submit";var z=angular.element(document.querySelector("#headerCtrl")).scope();z.theTab=y;var A=angular.element(document.querySelector("#header"));g.scrollToElement(A);var B=angular.element("#default");return B.focus(),i.log({status:"One question is unanswered. Moving to previous section.",question:p,section:w}),!1}}i.log({status:"No question is unanswered. Submiting form."}),"undefined"!=typeof h?(i.log({status:"Calling",api:"/forms_complete/form/"+a.formId+"/"+h+"/"}),c.post("/forms_complete/form/"+a.formId+"/"+h+"/").success(function(){console.log("app submitted successfully"),a.busySubmit=!1,i.log({status:"Success"}),setTimeout(function(){var a="//"+d.location.host+"/forms_complete/done/";d.location.href=a},500)}).error(function(b){a.busySubmit=!1,a.buttonText="Submit",a.error="Application could not be submitted, please retry",i.log({status:"Error",response:b})})):(i.log({status:"Calling",api:"/forms_complete/form/"+a.formId+"/"}),c.post("/forms_complete/form/"+a.formId+"/").success(function(){console.log("app submitted successfully"),a.busySubmit=!0,i.log({status:"Success"}),setTimeout(function(){var a="//"+d.location.host+"/forms_complete/done/";d.location.href=a},500)}).error(function(b){a.error="Application could not be submitted, please retry",i.log({status:"Error",response:b})}))}}}]),forms.controller("headerController",["$scope","$rootScope","Form","appFunc","$document","$timeout","jsonLogger",function(a,b,c,d,e,f,g){var h=new g;a.init=function(){a.theTab=1},a.selectedSect=function(b){a.theTab=b.index},a.isDisabledSection=function(c){return b.globalUser&&""!==b.globalUser?!1:c+1!==a.theTab?!0:void 0},a.moveToSection=function(c){if(1!=a.isDisabledSection(c)&&b.globalUser&&""!==b.globalUser){var e=angular.element(document.querySelector("#body-container")).scope();e.section=e.form.sections[c],a.theTab=c+1;var f=h.getMetaData();f.caller="headerController.moveToSection",h.setMetaData(f),h.log({status:"Moving to section.",section:e.section,isDisabledSection:a.isDisabledSection(c)}),d.setSection(e.section)}}}]),forms.controller("header",["$http","$scope","$rootScope","jsonLogger",function(a,b,c,d){var e=new d;a({method:"GET",url:"/generic/user_info/"}).then(function(a,b,d,f){c.firstname=a.data.self.f_name,c.lastname=a.data.self.l_name,c.useridnum=a.data.self.user_id,c.userrole=a.data.self.role,c.persona=a.data.self.persona_id;var g=e.getLoggerData();return"undefined"!=typeof g.login_user_id&&""!==g.login_user_id.toString().trim()&&0!==g.login_user_id.length||(g.login_user_id=a.data.self.user_id,e.setLoggerData(g)),a.data},function(a){return console.log(a),a})}]),forms.directive("compile",["$compile",function(a){return function(b,c,d,e,f){b.$watch(function(a){return a.$eval(d.compile)},function(d){var e,f,g;g=angular.element(document.createElement("div")),g.html(d);var h=c.contents();f=angular.element(g[0].querySelector("[ng-transclude]")),f.length&&f.replaceWith(h.clone()),e=g.contents(),c.html(e),a(c.contents())(b)})}}]);;
angular.module("imForm").run(["$templateCache",function(a){"use strict";a.put("/new_platform/static/apiforms/nghtml/application-submitted-mentee.html",'<div class="asubmitted" ng-controller="AppSubmittedController">\n    <div class="centered">\n        <div class="appinfo">\n            <h1 style="font-family: \'Helvetica Neue\', Helvetica, Arial, sans-serif">Your application has been submitted!</h1>\n            <div class="margin20"></div>\n\n            <div class="row">\n                <a class=""><button ng-click="continue()" class="button-all button-med orange bolded">Continue</button></a>\n            </div>\n        </div>\n    </div>\n</div>'),a.put("/new_platform/static/apiforms/nghtml/application-submitted.html",'<div class="asubmitted" ng-controller="AppSubmittedController">\n    <div class="centered">\n        <div class="appinfo">\n            <h1 style="font-family: \'Helvetica Neue\', Helvetica, Arial, sans-serif">{{message}}</h1>\n            <div class="margin20"></div>\n\n            <div class="row">\n                <a class=""><button ng-click="continue()" class="button-all button-med orange bolded">Continue</button></a>\n            </div>\n        </div>\n    </div>\n</div>'),a.put("/new_platform/static/apiforms/nghtml/header-bar.html",'<div class="navbar navbar-default" role="navigation" ng-controller="header">\n  <div class="container-fluid">\n    <div class="navbar-header">\n      <!--<hamburger-toggle state="tgState" class="hamburger-toggle"></hamburger-toggle>-->\n      <span class="navbar-brand">\n        Intake Application\n      </span>\n      <span ng-show="busy" class="statusNotifications">Loading...</span>\n      <span class="statusNotifications">[[formSaving]]</span>\n      <div class="notifications">\n        <span ng-if="userrole === \'Mentor\' || userrole === \'Mentee\'" class="username"><a href="/iuser/myinfo/[[persona]]/">[[firstname]] [[lastname.split(\'\')[0] ]]</a></span>\n        <span ng-if="userrole !== \'Mentor\' && userrole !== \'Mentee\'" class="username"><a href="/iuser/backend_profile/[[persona]]/">[[firstname]] [[lastname.split(\'\')[0] ]]</a></span>\n        <!--<i class="glyphicon glyphicon-comment"></i>--></div>\n    </div>\n  </div>\n</div>\n\n\n<div class="sidenav" ng-class="{open: tgState}">\n  <ul class="nav nav-pills nav-stacked">\n    <li ui-sref-active="active"><a ui-sref="home">Intake Application</a></li>\n    <li><a href="/events/personal/">Calendar</a></li>\n    <li><a href="/iuser/myinfo/[[persona]]/" >Profile</a></li>\n    <!--<li ng-show="userrole === \'Mentee\'"><a href="https://learn.imentor.org/help/article/link/imentor-curriculum">Resources</a></li>-->\n    <li ng-show="userrole !== \'Mentee\'"><a href="https://learn.imentor.org/help/article/link/home" target="_blank">Learning Center</a></li>\n    <li ui-sref-active="active"><a href="/iuser/logout/">Sign out</a></li>\n  </ul>\n  <!-- <hamburger-toggle state="tgState" class="hamburger-toggle"></hamburger-toggle>-->\n</div>'),a.put("/new_platform/static/apiforms/nghtml/header_tabs.html",'<div class="form-header" id="header">\n  <h1 style="color:#FFFFFF;">[[description]]</h1>\n  <!--<div class="spinner" ng-show="busy"><img ng-src="/new_platform/static/apiforms/img/dots.gif"  alt="Loading icon"><h3>Please wait while we generate your application...</h3></div>-->\n  <div class="logout" ng-click="logout()"><a>Sign out</a></div>\n  <br/>\n\n  <ul class="nav navbar-nav thetabs" ng-controller="headerController" ng-init="init()" id="headerCtrl">\n    <li id="[[$index + 1]]" ng-repeat="sect in sections | orderBy:\'ordinal\'" ng-class="{active:\'[[$index + 1]]\' == theTab, disabled: isDisabledSection($index), past: \'[[$index + 1]]\' < theTab, \'mentorTab\': sections.length == 4, \'menteeTab\': sections.length == 3}" class="form-sections">\n      <a class="tabLinks" ng-click="moveToSection($index)" ng-class="{pointer: \'[[$index + 1]]\' != theTab}">[[sect.description]]</a>\n    </li></ul>\n</div>\n[[theTab]]')}]);;
angular.module("imForm").run(["$templateCache",function(a){"use strict";a.put("/new_platform/static/apiforms/drtvhtml/academic.html",'<!--ng_required doesn\'t make any sense-->\n\n<!-- Type =20 <br/>-->\n<div style="display: inline-block;">\n  <span class="questiontext" ng-bind-html="htmlText"></span>\n\n  <div ng-repeat="obj in academics track by $index"\n       ng-disabled="!question.is_active"\n       ng-click="update(obj)"\n       ng-enter="update(obj)"\n       ng-class="{\'selected\': obj.selected==true }"\n       class="multi-select-field"\n       tabindex="[[tabIndex]]"\n      >\n    <span class="answer">[[obj.name]]</span><span style="float: right;"  ng-class="{\'selected\': obj.selected==true }" class="glyphicon glyphicon-ok" aria-hidden="true"></span>\n  </div>\n</div>\n<span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n<span class="error">[[error]]</span>\n\n\n'),a.put("/new_platform/static/apiforms/drtvhtml/address.html",'\n<!--Type: 4 <br/> -->\n<div >\n  <span class="questiontext" ng-bind-html="htmlText"></span>\n  <div class="address-input" id="address">\n    <input type="text"\n           id="address-street1"\n           ng-required="question.is_required"\n           ng-model="question.user_response.user_response.address"\n           placeholder="Address"\n           ng-blur="update()"\n           ng-change="updateRequired()"\n           name = "address1"\n           tabindex="[[tabIndex]]"\n           ng-disabled="question.onBackendCall == true"\n        />\n      <!--<span ng-show="myForm.address1.$error.required && myForm.address1.$touched" class="form-error">[[fieldErrMsg]]</span>-->\n    <input type="text"\n           id="address-street2"\n           ng-required="question.is_required"\n           ng-model="question.user_response.user_response.city"\n           placeholder="City"\n           ng-blur="update()"\n           ng-change="updateRequired()"\n           name="address2"\n           tabindex="[[tabIndex+1]]"\n           ng-disabled="question.onBackendCall == true"\n        />\n    <!--<span ng-show="myForm.address2.$error.required && myForm.address2.$touched" class="form-error">[[fieldErrMsg]]</span>-->\n    <br/>\n\n\n    <select ng-model="state"\n            id= "address-state"\n            ng-options="state as state.name for state in states"\n            ng-required="question.is_required"\n            ng-change="update()"\n            ng-disabled="!question.is_active || question.onBackendCall == true"\n            ng-change="updateRequired()"\n            name="address3"\n            tabindex="[[tabIndex+2]]"\n        >\n            <option value="">State</option>\n    </select>\n    <!--<span ng-show="myForm.address3.$error.required && myForm.address3.$touched" class="form-error">[[fieldErrMsg]]</span>-->\n    <br/>\n    <input type="text"\n           id="address-zip"\n           ng-required="question.is_required"\n           ng-model="question.user_response.user_response.zipcode"\n           placeholder="Zip Code"\n           ng-blur="update()"\n           ng-change="updateRequired()"\n           maxlength="5"\n           name="address4"\n           tabindex="[[tabIndex+3]]"\n           ng-disabled="question.onBackendCall == true"\n        />\n    <!--<span ng-show="myForm.address4.$error.required && myForm.address4.$touched" class="form-error">[[fieldErrMsg]]</span>-->\n    <span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n    <span class="error">[[error]]</span>\n  </div>\n\n</div>'),a.put("/new_platform/static/apiforms/drtvhtml/career.html",'<!--ng_required doesn\'t make any sense-->\n\n <!-- Type =18 <br/>-->\n<div style="display: inline-block;">\n  <span class="questiontext" ng-bind-html="htmlText"></span>\n\n  <div ng-repeat="obj in careersOnly track by $index"\n       ng-disabled="!question.is_active"\n       ng-click="update(obj)"\n       ng-enter="update(obj)"\n       ng-class="{\'selected\': obj.selected==true }"\n       class="multi-select-field"\n       tabindex="[[tabIndex]]"\n      >\n    <span class="answer">[[obj.name]]</span><span style="float: right;"  ng-class="{\'selected\': obj.selected==true }" class="glyphicon glyphicon-ok" aria-hidden="true"></span>\n  </div>\n</div>\n<span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n<span class="error">[[error]]</span>\n\n\n'),a.put("/new_platform/static/apiforms/drtvhtml/career_occupation.html",'<!--ng_required doesn\'t make any sense-->\n<!--Type =17 <br/>-->\n\n<div style="display: inline-block;">\n  <span class="questiontext" ng-bind-html="htmlText"></span>\n  <br/>\n  <div ng-repeat="obj in careers track by $index"\n       ng-disabled="!question.is_active"\n       ng-click="selectCareer(obj)"\n       ng-enter="selectCareer(obj)"\n       ng-class="{\'selected\': career==obj}"\n       class="multi-select-field"\n       name="career1"\n       tabindex="[[tabIndex+$index]]"\n      >\n    <span class="answer">[[obj.name]]</span><span style="float: right;"  ng-class="{\'selected\': career==obj}" aria-hidden="true"></span>\n  </div>\n\n  <br/>\n  <span class="questiontext occupation">Occupations: for [[career.name]] </span>\n  <div ng-repeat="obj in career.occupations track by $index"\n       ng-disabled="!question.is_active"\n       ng-click="selectOccupation(obj)"\n       ng-enter="selectOccupation(obj)"\n       ng-class="{\'selected\': obj.selected==true }"\n       class="occupations multi-select-field2"\n       name="career2"\n       tabindex="[[tabIndex+50+$index]]"\n      >\n    <span class="answer">[[obj.name]]</span><span style="float: right;"  ng-class="{\'selected\': obj.selected==true }" class="glyphicon glyphicon-ok" aria-hidden="true"></span>\n  </div>\n</div>\n\n<span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n<span class="error">[[error]]</span>\n\n'),a.put("/new_platform/static/apiforms/drtvhtml/datetime.html",'<!--Type: 14 <br/>-->\n<span class="questiontext" ng-bind-html="htmlText" style="margin-bottom: 0px;"></span>\n<div>\n  <select ng-model="month"\n          ng-options="month as month.title for month in months"\n          ng-change="refreshDays()"\n          ng-blur="update()"\n          ng-disabled="!question.is_active || question.onBackendCall == true"\n          tabindex="[[tabIndex]]"\n\n      >\n    <option value="">Month</option>\n  </select>\n\n  &nbsp;\n  <select ng-model="day"\n          ng-options="day as day.id for day in days"\n          ng-change="updateRequired()"\n          ng-blur="update()"\n          ng-disabled="!question.is_active || question.onBackendCall == true"\n          tabindex="[[tabIndex+1]]"\n      >\n    <option value="">Day</option>\n  </select>\n\n  &nbsp;\n  <select ng-model="year"\n          ng-options="year as year for year in years"\n          ng-change="updateRequired()"\n          ng-blur="update()"\n          ng-disabled="!question.is_active || question.onBackendCall == true"\n          tabindex="[[tabIndex+2]]"\n      >\n    <option value="">Year</option>\n  </select>\n\n  <span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n  <span class="error">[[error]]</span>\n</div>\n'),a.put("/new_platform/static/apiforms/drtvhtml/dropdown.html",'\n<!--Type: 8 <br/>-->\n<div>\n  <select ng-model="answer"\n          ng-options="ele as ele.answer_text for ele in answers"\n          ng-disabled="!question.is_active || question.onBackendCall == true"\n          ng-change = "update()"\n          tabindex="[[tabIndex]]"\n      >\n    <option value="">[[question.question_text]]</option>\n  </select>\n  <span ng-show="question.required  && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n  <span class="error" >[[error]]</span> <br/>\n</div>'),a.put("/new_platform/static/apiforms/drtvhtml/dropdown_college.html",'<!--Type: 12-->\n<div style="display: inline-block;">\n  <div>\n    <input type="text"\n           class="form-control question-ptext"\n           ng-model="college"\n           ng-class="{\'not-required\' : colleges.length > 0}"\n           placeholder="[[question.question_text]]"\n           ng-required="question.is_required"\n           typeahead-min-length="3"\n           ng-disabled="!question.is_active || question.onBackendCall == true"\n           typeahead="college.name for college in getColleges($viewValue)"\n           typeahead-loading="loadingColleges"\n           typeahead-on-select=\'onSelect($item, $model, $label)\'\n           ng-blur = "updateValidState()"\n           ng-change = "updateValidState()"\n           name="college1"\n           tabindex="[[tabIndex]]"\n        >\n    <!--<i ng-show="loadingColleges" class="glyphicon glyphicon-refresh"></i>-->\n  </div>\n  <div ng-repeat="college in colleges track by $index" class="selected" style="width: 75%;" id="collegeList">\n    <div style="padding: 10px 15px; margin-top: 5px;" id="college-[[$index]]">\n      [[college.name]]\n      <span style="cursor: pointer;" class="pull-right" ng-click="removeCollege(college)" ng-enter="removeCollege(college)" tabindex="[[tabIndex+1+$index]]">\n        <i class="fa fa-times" style="padding-right: 0px;"></i>\n      </span>\n    </div>\n  </div>\n\n</div>\n<span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n<span class="error">[[error]]</span>\n'),a.put("/new_platform/static/apiforms/drtvhtml/dropdown_country.html",'<!--Type: 9 <br/>-->\n<div >\n   <select ng-model="country"\n          ng-options="country as country.name for country in countries"\n          ng-disabled="!question.is_active || question.onBackendCall == true"\n          ng-change = "update()"\n          tabindex="[[tabIndex]]"\n       >\n    <option value="">[[question.question_text]]</option>\n  </select>\n  <span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n  <span class="error">[[error]]</span> <br/>\n</div>'),a.put("/new_platform/static/apiforms/drtvhtml/dropdown_dependence.html",'<!--Type: 23-->\n<div>\n\n  <input type="text"\n         ng-model="employer1"\n         placeholder="[[question.question_text]]"\n         ng-required="question.is_required"\n         typeahead-min-length="3"\n         ng-disabled="!question.is_active || question.onBackendCall == true"\n         typeahead="employer.name for employer in getEmployers($viewValue)"\n         typeahead-loading="loadingEmployers"\n         typeahead-on-select=\'onSelect($item, $model, $label)\'\n         ng-change = "clearEmployer()"\n         ng-blur="update()"\n         tabindex="[[tabIndex]]"\n         class="form-control">\n  <!--<i ng-show="loadingEmployers" class="glyphicon glyphicon-refresh"></i>-->\n  <br/>\n  <input type="text"\n         ng-required="question.dependence_required"\n         placeholder="If your employer was not listed above, please list it here"\n         ng-model="employer2"\n         ng-blur="update()"\n         ng-change="updateRequired()"\n         class="question-ptext"\n         name="textbox1"\n         tabindex="[[tabIndex+1]]"\n         ng-disabled="question.onBackendCall == true"\n         ng-show="!employer || !employer.id"\n      />\n  <span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n  <span class="error">[[error]]</span>\n</div>\n'),a.put("/new_platform/static/apiforms/drtvhtml/dropdown_employer.html",'<!--Type: 11-->\n<div>\n  <div style="display: inline-block;">\n    <input type="text"\n           ng-model="question.user_response.user_response"\n           placeholder="[[question.question_text]]"\n           ng-required="question.is_required"\n           typeahead-min-length="3"\n           ng-disabled="!question.is_active || question.onBackendCall == true"\n           typeahead="employer.name for employer in getEmployers($viewValue)"\n           typeahead-loading="loadingEmployers"\n           typeahead-on-select=\'onSelect($item, $model, $label)\'\n           ng-change = "clearEmployer()"\n           ng-blur="update()"\n           tabindex="[[tabIndex]]"\n           class="form-control">\n    <!--<i ng-show="loadingEmployers" class="glyphicon glyphicon-refresh"></i>-->\n  </div>\n  <span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n  <span class="error">[[error]]</span>\n</div>\n'),a.put("/new_platform/static/apiforms/drtvhtml/dropdown_school.html",'\n<!--Type: 13 <br/>-->\n<div>\n  <div class="schoolblock">\n    <span class="questiontext" ng-bind-html="htmlText"></span>\n    <select ng-model="schoolName"\n            ng-options="k as k for (k, v) in schools"\n            ng-disabled="!question.is_active || question.onBackendCall == true"\n            ng-change="updateRequired()"\n            tabindex="[[tabIndex]]"\n        >\n      <option value="">Select your school</option>\n    </select>\n    <br/>\n     <select ng-model="class"\n            ng-options="class as class.class for class in schools[schoolName]"\n            ng-change = "update()"\n            ng-disabled="!question.is_active || question.onBackendCall == true"\n            tabindex="[[tabIndex+1]]"\n         >\n      <option value="">Select your class</option>\n    </select>\n\n    <span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n    <span class="error">[[error]]</span>\n  </div>\n</div>\n'),a.put("/new_platform/static/apiforms/drtvhtml/dropdown_state.html",'<!--Type: 10 <br/>-->\n\n<div>\n   <select ng-model="state"\n          ng-options="state as state.name for state in states"\n          ng-disabled="!question.is_active || question.onBackendCall == true"\n          ng-change = "update()"\n          tabindex="[[tabIndex]]"\n       >\n    <option value="">[[question.question_text]]</option>\n  </select>\n  <span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n  <span class="error" >[[error]]</span> <br/>\n</div>'),a.put("/new_platform/static/apiforms/drtvhtml/heading.html",'<!--Type: 15 <br/>-->\n<style>\n  .heading-form{\n    margin-bottom: -10px;\n  }\n</style>\n<h3 class="heading-form" ng-bind-html="htmlText" tabindex="-1"></h3>\n\n'),a.put("/new_platform/static/apiforms/drtvhtml/instruction.html",'\n<!--Type: 16 <br/>-->\n<div class="questiontext" ng-bind-html="htmlText" tabindex="[[tabIndex]]"></div>\n'),a.put("/new_platform/static/apiforms/drtvhtml/multi_select.html",'\n<!--ng_required doesn\'t make any sense-->\n<!--Type =7 -->\n<div style="display: inline-block;">\n  <span class="questiontext" ng-bind-html="htmlText"></span>\n  <div ng-repeat="answer in question.answers track by $index"\n       ng-disabled="!answer.is_active"\n       ng-class="{\'selected\': answer.selected==true }"\n       class="multi-select-field"\n       ng-click="update(answer)"\n       ng-enter="update(answer)"\n       name="multisel1"\n       tabindex="[[tabIndex + $index]]"\n      >\n    <span class="answer">[[answer.answer_text]]</span>\n    <span style="float: right;"  ng-class="{\'selected\': answer.selected==true }" class="glyphicon glyphicon-ok" aria-hidden="true"></span>\n  </div>\n</div>\n\n<span ng-show="question.required  && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n<span class="error">[[error]]</span>\n\n'),a.put("/new_platform/static/apiforms/drtvhtml/nopref_toggle.html",'<!--ng_required doesn\'t make any sense-->\n\n<!-- Type =22 <br/>-->\n<div style="display: inline-block;">\n  <span class="questiontext" ng-bind-html="htmlText"></span>\n\n  <div ng-repeat="obj in answers | orderBy:\'ordinal\' track by $index "\n    ng-disabled="!question.is_active"\n    ng-click="update(obj)"\n    ng-enter="update(obj)"\n    ng-class="{\'selected\': obj.selected==true }"\n    class="multi-select-field"\n    tabindex="[[tabIndex+$index]]"\n  >\n    <span class="answer">[[obj.answer_text]]</span><span style="float: right;"  ng-class="{\'selected\': obj.selected==true }" class="glyphicon glyphicon-ok" aria-hidden="true"></span>\n  </div>\n</div>\n<span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n<span class="error">[[error]]</span>\n\n\n'),a.put("/new_platform/static/apiforms/drtvhtml/phonebox.html",'<!--Type:3-->\n<div class="phonebox">\n  <span class="questiontext" ng-bind-html="htmlText"></span>\n  <input type="text"\n         ng-required="question.is_required"\n         ng-model="phoneNumbers[0]"\n         ng-blur="update()"\n         maxlength="3"\n         class="phone-number"\n         ng-change="moveFocus(0)"\n         tabindex="[[tabIndex]]"\n         ng-readonly="question.onBackendCall == true"\n      />\n  -\n  <input type="text"\n         ng-required="question.is_required"\n         ng-model="phoneNumbers[1]"\n         ng-blur="update()"\n         maxlength="3"\n         ng-change="moveFocus(1)"\n         class="phone-number"\n         tabindex="[[tabIndex+1]]"\n         ng-readonly="question.onBackendCall == true"\n      />\n  -\n  <input type="text"\n         ng-required="question.is_required"\n         ng-model="phoneNumbers[2]"\n         ng-blur="update()"\n         maxlength="4"\n         ng-change="moveFocus(2)"\n         class="phone-number"\n         tabindex="[[tabIndex+2]]"\n         ng-readonly="question.onBackendCall == true"\n    />\n  <span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n  <span class="error">[[error]]</span>\n</div>\n\n'),a.put("/new_platform/static/apiforms/drtvhtml/program.html",'<!-- Type =21 <br/>-->\n<div style="display: inline-block;">\n  <span class="questiontext" ng-bind-html="htmlText"></span>\n\n  <div ng-repeat="obj in programs track by $index"\n       ng-disabled="!question.is_active"\n       ng-click="update(obj)"\n       ng-enter="update(obj)"\n       ng-class="{\'selected\': obj.selected==true }"\n       class="multi-select-field"\n       tabindex="[[tabIndex+$index]]"\n      >\n    <span class="answer">[[obj.name]]</span><span style="float: right;"  ng-class="{\'selected\': obj.selected==true }" class="glyphicon glyphicon-ok" aria-hidden="true"></span>\n  </div>\n</div>\n<span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n<span class="error">[[error]]</span>\n\n\n'),a.put("/new_platform/static/apiforms/drtvhtml/racial.html",'<!--ng_required doesn\'t make any sense-->\n\n<!-- Type =19 <br/>-->\n<div style="display: inline-block;">\n  <span class="questiontext" ng-bind-html="htmlText"></span>\n\n  <div ng-repeat="obj in racials | orderBy:\'ordinal\' track by $index "\n       ng-disabled="!question.is_active"\n       ng-click="update(obj)"\n       ng-enter="update(obj)"\n       ng-class="{\'selected\': obj.selected==true }"\n       class="multi-select-field"\n       tabindex="[[tabIndex+$index]]"\n      >\n    <span class="answer">[[obj.group]]</span><span style="float: right;"  ng-class="{\'selected\': obj.selected==true }" class="glyphicon glyphicon-ok" aria-hidden="true"></span>\n  </div>\n</div>\n<span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n<span class="error">[[error]]</span>\n\n\n'),a.put("/new_platform/static/apiforms/drtvhtml/select_toggle.html",'<!--Type: 5 <br/> -->\n<div class="actions button-toggle" >\n  <span class="questiontext" ng-bind-html="htmlText"></span>\n  <button\n      class="yes pull-left"\n      ng-class="{\'selected\': question.user_response.answer_id == yesAnswer.id, \'required\': question.is_required }"\n      ng-click = "update(yesAnswer) "\n      tabindex="[[tabIndex]]"\n      ng-class="{\'required\': question.is_required}"\n      ng-disabled="question.onBackendCall == true"\n      >\n    [[yesAnswer.answer_text]]\n  </button>\n\n  <button\n      class="no pull-left"\n      ng-class="{\'selected\': question.user_response.answer_id == noAnswer.id, \'required\': question.is_required }"\n      ng-click = "update(noAnswer)"\n      tabindex="[[tabIndex+1]]"\n      ng-disabled="question.onBackendCall == true"\n      >\n    [[noAnswer.answer_text]]\n  </button>\n  <span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n  <span class="error">[[error]]</span>\n</div>\n\n'),a.put("/new_platform/static/apiforms/drtvhtml/single_select_radio.html",'\n<!--Type 6: <br/>-->\n<!--ng_required doesn\'t make any sense-->\n<div style="display: inline-block;">\n  <span class="questiontext" ng-bind-html="htmlText"></span>\n  <div ng-repeat="answer in question.answers track by $index"\n       ng-class="{\'selected\': question.user_response.answer_id == answer.id }"\n       ng-disabled="!answer.is_active"\n       ng-click = "update(answer)"\n       ng-enter="update(answer)"\n       style=""\n       class="multi-select-field"\n       tabindex="[[tabIndex + $index]]"\n      >\n    [[answer.answer_text]]\n  </div>\n</div>\n<span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n<span class="error">[[error]]</span>\n\n\n\n'),a.put("/new_platform/static/apiforms/drtvhtml/textarea.html",'<!--Type:1 <br/>-->\n<div>\n  <span class="questiontext" ng-bind-html="htmlText"></span>\n  <textarea\n      ng-required="question.is_required"\n      ng-blur="update()"\n      ng-model="question.user_response.user_response"\n      ng-change="updateRequired()"\n      tabindex="[[tabIndex]]"\n      ng-disabled="question.onBackendCall == true"\n      >\n  </textarea>\n  <span ng-show="question.required && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n  <span class="error">[[error]]</span> <br/>\n</div>'),a.put("/new_platform/static/apiforms/drtvhtml/textbox.html",'\n<!--Type:2 <br/>-->\n<div>\n  <input type="text"\n         ng-required="question.is_required"\n         placeholder="[[question.question_text]]"\n         ng-model="question.user_response.user_response"\n         ng-blur="update()"\n         ng-change="updateRequired()"\n         class="question-ptext"\n         name="textbox1"\n         tabindex="[[tabIndex]]"\n         ng-disabled="question.onBackendCall == true"\n      />\n  <span ng-show="question.required == true && question.edited == true && question.showRequired == true" class="form-error">[[fieldErrMsg]]</span>\n  <span class="error">[[error]]</span> <br/>\n</div>')}]);;
var forms=angular.module("imForm");forms.directive("singleSelectRadio",["appFunc","$sce",function(a,b){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/single_select_radio.html",link:function(c,d,e,f){c.htmlText=b.trustAsHtml(c.question.question_text),c.updateRequired=function(){return c.question.showRequired=!1,c.question.edited=!0,c.question.is_visible!==!0||c.question.is_required!==!0?(c.question.required=!1,!1):(c.question.user_response&&c.question.user_response.answer_id?c.question.required=!1:c.question.required=!0,c.error&&""!=c.error?(console.log("Question has error."),c.question.required=!0,!1):c.question.required)},c.update=function(b){var d=null;b.id===c.question.user_response.answer_id?a.deleteUserResponse(c.question,c).then(function(a){1==a.success&&(c.question.user_response.answer_id=0),c.updateRequired()},function(a){c.updateRequired()}):(d={user_response:{answer_id:b.id,question_id:c.question.id,user_response:null}},a.updateUserResponse(c.question,d,c).then(function(a){1==a.success&&(c.question.user_response.answer_id=b.id),c.updateRequired()},function(a){c.updateRequired()}))},c.updateRequired(),c.question.edited=!1,c.tabIndex=100*c.question.ordinal+c.question.sub_ordinal,c.question.updateRequired=c.updateRequired}}}]),forms.directive("dropdown",["appFunc","$sce",function(a,b){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/dropdown.html",link:function(c,d,e,f){c.htmlText=b.trustAsHtml(c.question.question_text),c.answers=c.question.answers,c.question.user_response.answer_id&&(c.answer=_.findWhere(c.answers,{id:c.question.user_response.answer_id})||null),c.updateRequired=function(){return c.question.showRequired=!1,c.question.is_visible!==!0||c.question.is_required!==!0?(c.question.required=!1,!1):(c.answer&&c.answer.id?c.question.required=!1:c.question.required=!0,c.error&&""!=c.error?(console.log("Question has error."),c.question.required=!0,!1):c.question.required)},c.update=function(){if(c.question.edited=!0,c.updateRequired()!==!0){var b={user_response:{answer_id:c.answer.id,question_id:c.question.id,user_response:null}};a.updateUserResponse(c.question,b,c).then(function(){c.updateRequired()},function(){c.updateRequired()})}},c.updateRequired(),c.question.edited=!1,c.tabIndex=100*c.question.ordinal+c.question.sub_ordinal,c.question.updateRequired=c.updateRequired}}}]),forms.directive("dropdownCountry",["$compile","appFunc","$sce",function(a,b,c){return{restrict:"AEC",scope:{question:"=",countries:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/dropdown_country.html",link:function(a,d,e,f){a.htmlText=c.trustAsHtml(a.question.question_text),a.question.user_response.selected_id&&(a.country=_.findWhere(a.countries,{id:a.question.user_response.selected_id})||null),a.updateRequired=function(){return a.question.showRequired=!1,a.question.edited=!0,a.question.is_visible!==!0||a.question.is_required!==!0?(a.question.required=!1,!1):(a.country&&a.country.id?a.question.required=!1:a.question.required=!0,a.error&&""!=a.error?(console.log("Question has error."),a.question.required=!0,!1):a.question.required)},a.update=function(){if(a.updateRequired()!==!0){var c={user_response:{answer_id:a.country.id,question_id:a.question.id,user_response:null}};b.updateUserResponse(a.question,c,a).then(function(){a.updateRequired()},function(){a.updateRequired()})}},a.updateRequired(),a.question.edited=!1,a.tabIndex=100*a.question.ordinal+a.question.sub_ordinal,a.question.updateRequired=a.updateRequired}}}]),forms.directive("dropdownState",["$compile","appFunc","$sce",function(a,b,c){return{restrict:"AEC",scope:{question:"=",states:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/dropdown_state.html",link:function(a,d,e,f){a.htmlText=c.trustAsHtml(a.question.question_text),a.question.user_response.answer_id&&(a.state=_.findWhere(a.states,{id:a.question.user_response.answer_id})||null),a.updateRequired=function(){return a.question.showRequired=!1,a.question.is_visible!==!0||a.question.is_required!==!0?(a.question.required=!1,!1):(a.state&&a.state.id?a.question.required=!1:a.question.required=!0,a.error&&""!=a.error?(a.question.required=!0,console.log("Question has error."),!1):a.question.required)},a.update=function(){if(a.question.edited=!0,a.updateRequired()!==!0){var c={user_response:{answer_id:a.state.id,question_id:a.question.id,user_response:null}};b.updateUserResponse(a.question,c,a).then(function(){a.updateRequired()},function(){a.updateRequired()})}},a.updateRequired(),a.question.edited=!1,a.tabIndex=100*a.question.ordinal+a.question.sub_ordinal,a.question.updateRequired=a.updateRequired}}}]),forms.directive("dropdownCollege",["$compile","College","appFunc","$sce",function(a,b,c,d){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/dropdown_college.html",link:function(a,e,f,g){a.htmlText=d.trustAsHtml(a.question.question_text),a.colleges=[];var h=a.question.user_response.user_response;h&&h.colleges&&_.each(h.colleges,function(b){a.colleges.push(b)}),a.updateValidState=function(){null===(a.college||null)&&0===a.colleges.length?a.question.isValidState=!1:a.question.isValidState=!0},a.getColleges=function(a){return b.query({filter:a}).$promise.then(function(a){return 0==a.length?[{id:0,name:"Not Listed"}]:a})},a.updateRequired=function(){return a.question.showRequired=!1,a.question.is_visible!==!0||a.question.is_required!==!0?(a.question.required=!1,!1):(0===a.colleges.length?a.question.required=!0:a.question.required=!1,a.error&&""!=a.error?(console.log("Question has error."),a.question.required=!0,!1):a.question.required)},a.onSelect=function(b,c,d){if(a.college="",a.question.edited=!0,0===b.id)0===a.colleges.length&&(a.colleges.push(b),a.update());else{var e=_.findWhere(a.colleges,{id:b.id});"undefined"==typeof e&&(a.colleges.push(b),a.update())}a.updateValidState()},a.removeCollege=function(b){a.question.edited=!0;var c=_.findWhere(a.colleges,{id:b.id});"undefined"!=typeof c&&(a.colleges=_.without(a.colleges,c),a.update())},a.update=function(){if(a.updateRequired()!==!0){var b={colleges:a.colleges},d={user_response:{answer_id:0,question_id:a.question.id,user_response:b}};c.updateUserResponse(a.question,d,a).then(function(){a.updateRequired()},function(){a.updateRequired()})}},a.updateRequired(),a.question.edited=!1,a.tabIndex=100*a.question.ordinal+a.question.sub_ordinal,a.question.updateRequired=a.updateRequired}}}]),forms.directive("heading",["$compile","appFunc","$sce",function(a,b,c){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"="},templateUrl:"/new_platform/static/apiforms/drtvhtml/heading.html",link:function(a,b,d,e){a.tabIndex=100*a.question.ordinal+a.question.sub_ordinal,a.htmlText=c.trustAsHtml(a.question.question_text)}}}]),forms.directive("instruction",["$compile","$sce","appFunc",function(a,b,c){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"="},templateUrl:"/new_platform/static/apiforms/drtvhtml/instruction.html",link:function(a,c,d,e){a.htmlText=b.trustAsHtml(a.question.question_text),a.tabIndex=100*a.question.ordinal+a.question.sub_ordinal}}}]),forms.directive("program",["appFunc","$sce",function(a,b){return{restrict:"AEC",scope:{question:"=",programs:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/program.html",link:function(c,d,e,f){c.htmlText=b.trustAsHtml(c.question.question_text);var g=c.question.user_response.user_response;if(c.programs=angular.copy(c.programs),g)for(var h=0;h<g.mprograms.length;h++){var i=_.find(c.programs,function(a){return a.id===g.mprograms[h]});"undefined"!=typeof i&&(i.selected=!0)}c.updateRequired=function(){if(c.question.showRequired=!1,c.question.is_visible!==!0||c.question.is_required!==!0)return c.question.required=!1,!1;var a=[];return _.each(c.programs,function(b){1==b.selected&&a.push(b.id)}),0==a.length?c.question.required=!0:c.question.required=!1,c.error&&""!=c.error?(console.log("Question has error."),c.question.required=!0,!1):c.question.required},c.update=function(b){c.question.edited=!0,b&&(b.selected=!b.selected);var d=[];if(_.each(c.programs,function(a){1==a.selected&&d.push(a.id)}),0==d.length)return void a.deleteUserResponse(c.question,c).then(function(a){1!=a.success&&(b.selected=!b.selected),c.updateRequired()},function(a){c.updateRequired()});if(c.updateRequired()!==!0){var e={mprograms:d},f={user_response:{answer_id:0,question_id:c.question.id,user_response:e}};a.updateUserResponse(c.question,f,c,c.programs).then(function(a){1!=a.success&&(b.selected=!b.selected),c.updateRequired()},function(a){c.updateRequired()})}},c.updateRequired(),c.question.edited=!1,c.tabIndex=100*c.question.ordinal+c.question.sub_ordinal,c.question.updateRequired=c.updateRequired}}}]),forms.directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){var d=b.which||b.keyCode;13===d&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}});;
var forms=angular.module("imForm");forms.directive("freeFormTextArea",["appFunc","$sce",function(a,b){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/textarea.html",link:function(c,d,e,f){c.htmlText=b.trustAsHtml(c.question.question_text),c.updateRequired=function(){return c.question.showRequired=!1,c.question.edited=!0,c.question.is_visible!==!0||c.question.is_required!==!0?(c.question.required=!1,!1):(c.question.user_response&&c.question.user_response.user_response?c.question.required=!1:c.question.required=!0,c.error&&""!=c.error?(console.log("Question has error."),c.question.required=!0,!1):c.question.required)},c.update=function(){if(c.prevValue!==c.question.user_response.user_response||angular.isDefined(c.question.hasSaveError)!==!1&&0!=c.question.hasSaveError)if(c.prevValue=c.question.user_response.user_response,"undefined"==typeof c.question.user_response.user_response||""==c.question.user_response.user_response)a.deleteUserResponse(c.question,c).then(function(){c.updateRequired()},function(){c.updateRequired()});else{if(c.updateRequired()===!0)return;var b={user_response:{answer_id:0,question_id:c.question.id,user_response:c.question.user_response.user_response}};a.updateUserResponse(c.question,b,c).then(function(){c.updateRequired()},function(){c.updateRequired()})}},"undefined"==typeof c.question.user_response.user_response?(c.question.user_response.user_response="",c.prevValue=""):c.prevValue=c.question.user_response.user_response,c.updateRequired(),c.question.edited=!1,c.tabIndex=100*c.question.ordinal+c.question.sub_ordinal,c.question.updateRequired=c.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("freeFormTextBox",["appFunc","$sce",function(a,b){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/textbox.html",link:function(c,d,e,f){c.htmlText=b.trustAsHtml(c.question.question_text),c.updateRequired=function(){return c.question.showRequired=!1,console.log("Call to update required triggered."),c.question.edited=!0,c.question.is_visible!==!0||c.question.is_required!==!0?(console.log("question.is_visible or question.is_required is not True."),c.question.required=!1,!1):(c.question.user_response&&c.question.user_response.user_response?(console.log("question.user_response or question.user_response.user_response is undefined or false."),c.question.required=!1):c.question.required=!0,c.error&&""!=c.error?(console.log("Question has error."),c.question.required=!0,!1):c.question.required)},c.update=function(){if(console.log("Call to update triggered."),c.prevValue===c.question.user_response.user_response&&(angular.isDefined(c.question.hasSaveError)===!1||0==c.question.hasSaveError))return void console.log("Exiting update. Previous value is current value.");if(c.prevValue=c.question.user_response.user_response,"undefined"==typeof c.question.user_response.user_response||""==c.question.user_response.user_response)console.log("Deleting response. Value is undefined or null."),a.deleteUserResponse(c.question,c).then(function(){c.updateRequired()},function(){c.updateRequired()});else{if(console.log("Checking if update is required."),c.updateRequired()===!0)return void console.log("Exiting update. Update required check returned true.");var b={user_response:{answer_id:0,question_id:c.question.id,user_response:c.question.user_response.user_response}};console.log("Updating response. Making POST call with Data : "+JSON.stringify(b)),a.updateUserResponse(c.question,b,c).then(function(){c.updateRequired()},function(){c.updateRequired()})}},"undefined"==typeof c.question.user_response.user_response?(c.question.user_response.user_response="",c.prevValue=""):c.prevValue=c.question.user_response.user_response,c.updateRequired(),c.question.edited=!1,c.tabIndex=100*c.question.ordinal+c.question.sub_ordinal,c.question.updateRequired=c.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("phoneBox",["$compile","appFunc","$sce",function(a,b,c){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/phonebox.html",link:function(a,d,e,f){a.htmlText=c.trustAsHtml(a.question.question_text),a.phoneNumbers=["","",""],a.prevValues=["","",""],a.question.user_response.user_response&&(a.phoneNumbers[0]=a.question.user_response.user_response.substring(0,3),a.phoneNumbers[1]=a.question.user_response.user_response.substring(3,6),a.phoneNumbers[2]=a.question.user_response.user_response.substring(6,10),a.prevValues[0]=a.phoneNumbers[0],a.prevValues[1]=a.phoneNumbers[1],a.prevValues[2]=a.phoneNumbers[2]),a.moveFocus=function(b){var c=angular.element("#q"+a.question.id+" .phone-box .phone-number");0!==b&&1!==b||a.phoneNumbers[b]&&a.phoneNumbers[b].length>=3&&c[b+1].focus(),a.updateRequired()},a.updateRequired=function(){if(a.question.showRequired=!1,a.question.edited=!0,a.question.is_visible!==!0||a.question.is_required!==!0)return a.question.required=!1,!1;for(var b=0;b<a.phoneNumbers.length;b++)if("undefined"==typeof a.phoneNumbers[b]||""===a.phoneNumbers[b])return a.question.required=!0,!0;return a.error&&""!=a.error?(console.log("Question has error."),a.question.required=!0,!1):(a.question.required=!1,!1)},a.update=function(){if(a.prevValues[0]!==a.phoneNumbers[0]||a.prevValues[1]!==a.phoneNumbers[1]||a.prevValues[2]!==a.phoneNumbers[2]||angular.isDefined(a.question.hasSaveError)!==!1&&(angular.isDefined(a.question.hasSaveError)!==!0||a.question.hasSaveError!==!1))if(a.prevValues[0]=a.phoneNumbers[0],a.prevValues[1]=a.phoneNumbers[1],a.prevValues[2]=a.phoneNumbers[2],a.phoneNumbers[0]||a.phoneNumbers[1]||a.phoneNumbers[2]){if(a.updateRequired()===!0)return;if(a.question.is_visible!==!0||a.question.is_required!==!0)for(var c=0;c<a.phoneNumbers.length;c++)if("undefined"==typeof a.phoneNumbers[c]||""===a.phoneNumbers[c])return!0;a.question.user_response.user_response=a.phoneNumbers[0]+a.phoneNumbers[1]+a.phoneNumbers[2];var d={user_response:{answer_id:0,question_id:a.question.id,user_response:a.question.user_response.user_response}};b.updateUserResponse(a.question,d,a).then(function(){a.updateRequired()},function(){a.updateRequired()})}else b.deleteUserResponse(a.question,a).then(function(){a.updateRequired()},function(){a.updateRequired()})},a.updateRequired(),a.question.edited=!1,a.tabIndex=100*a.question.ordinal+a.question.sub_ordinal,a.question.updateRequired=a.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("selectToggle",["appFunc","$sce",function(a,b){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/select_toggle.html",link:function(c,d,e,f){c.yesAnswer=c.question.answers[0],c.noAnswer=c.question.answers[1],c.htmlText=b.trustAsHtml(c.question.question_text),c.updateRequired=function(){return c.question.showRequired=!1,c.question.is_visible!==!0||c.question.is_required!==!0?(c.question.required=!1,!1):(c.question.user_response&&c.question.user_response.answer_id?c.question.required=!1:c.question.required=!0,c.error&&""!=c.error?(console.log("Question has error."),c.question.required=!0,!1):c.question.required)},c.update=function(b){if("undefined"==typeof c.question.user_response||c.question.user_response.answer_id!==b.id){c.question.edited=!0;var d={user_response:{answer_id:b.id,question_id:c.question.id,user_response:null}};a.updateUserResponse(c.question,d,c).then(function(a){1==a.success&&(c.question.user_response.answer_id=b.id),c.updateRequired()},function(a){c.updateRequired()})}},c.updateRequired(),c.question.edited=!1,c.tabIndex=100*c.question.ordinal+c.question.sub_ordinal,c.question.updateRequired=c.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("address",["$compile","appFunc","$sce",function(a,b,c){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"=",updateUserResponse:"&",states:"="},templateUrl:"/new_platform/static/apiforms/drtvhtml/address.html",link:function(a,d,e,f){a.htmlText=c.trustAsHtml(a.question.question_text),a.prevValue={},a.question.user_response.user_response&&a.question.user_response.user_response.state_id&&(a.state=_.findWhere(a.states,{id:a.question.user_response.user_response.state_id})||null),a.updateRequired=function(){return a.question.showRequired=!1,a.question.edited=!0,a.question.is_visible!==!0||a.question.is_required!==!0?(a.question.required=!1,!1):(a.question.user_response&&a.question.user_response.user_response&&a.question.user_response.user_response.address&&a.question.user_response.user_response.city&&a.question.user_response.user_response.zipcode&&a.state&&a.state.id?a.question.required=!1:a.question.required=!0,a.error&&""!=a.error?(console.log("Question has error."),a.question.required=!0,!1):a.question.required)},a.update=function(){var c="";if(c=a.state?a.state.id:"",a.prevValue.address!==a.question.user_response.user_response.address||a.prevValue.city!==a.question.user_response.user_response.city||a.prevValue.zipcode!==a.question.user_response.user_response.zipcode||a.prevValue.stateId!==c||angular.isDefined(a.question.hasSaveError)!==!1&&0!=a.question.hasSaveError)if(a.prevValue.address=a.question.user_response.user_response.address,a.prevValue.city=a.question.user_response.user_response.city,a.prevValue.zipcode=a.question.user_response.user_response.zipcode,a.prevValue.stateId=c,!a.question.user_response.hasOwnProperty("user_response")||a.question.user_response.user_response.address||a.question.user_response.user_response.city||a.question.user_response.user_response.zipcode||a.state){if(a.updateRequired()===!0)return;var d={address:a.question.user_response.user_response.address,city:a.question.user_response.user_response.city,state_id:a.state.id,zipcode:a.question.user_response.user_response.zipcode},e={user_response:{answer_id:0,question_id:a.question.id,user_response:d}};b.updateUserResponse(a.question,e,a).then(function(){a.updateRequired()},function(){a.updateRequired()})}else b.deleteUserResponse(a.question,a).then(function(){a.updateRequired()},function(){a.updateRequired()})},a.question.user_response.user_response?(a.prevValue.address=a.question.user_response.user_response.address,a.prevValue.city=a.question.user_response.user_response.city,a.prevValue.zipcode=a.question.user_response.user_response.zipcode,a.prevValue.stateId=a.question.user_response.user_response.state_id):(a.question.user_response.user_response={},a.prevValue.stateId=""),a.updateRequired(),a.question.edited=!1,a.tabIndex=100*a.question.ordinal+a.question.sub_ordinal,a.question.updateRequired=a.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("multiSelect",["appFunc","$sce",function(a,b){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/multi_select.html",link:function(c,d,e,f){c.htmlText=b.trustAsHtml(c.question.question_text),c.answers=c.question.answers;var g=c.question.user_response.user_response;if(g&&g.answer_ids)for(var h=0;h<g.answer_ids.length;h++){var i=_.findWhere(c.answers,{id:g.answer_ids[h]});"undefined"!=typeof i&&(i.selected=!0)}c.updateRequired=function(){if(c.question.showRequired=!1,c.question.edited=!0,c.question.is_visible!==!0||c.question.is_required!==!0)return c.question.required=!1,!1;var a=[];return _.each(c.answers,function(b){1==b.selected&&a.push(b.id)}),0===a.length?c.question.required=!0:c.question.required=!1,c.error&&""!=c.error?(console.log("Question has error."),c.question.required=!0,!1):c.question.required},c.update=function(b){var d=[];if(b&&(b.selected=!b.selected),_.each(c.answers,function(a){1==a.selected&&d.push(a.id)}),0==d.length)return void a.deleteUserResponse(c.question,c).then(function(a){1!=a.success&&(b.selected=!b.selected),c.updateRequired()},function(a){c.updateRequired()});if(c.updateRequired()!==!0){var e={answer_ids:d},f={user_response:{answer_id:0,question_id:c.question.id,user_response:e}};a.updateUserResponse(c.question,f,c,c.answers).then(function(a){1!=a.success&&(b.selected=!b.selected),c.updateRequired()},function(a){c.updateRequired()})}},c.updateRequired(),c.question.edited=!1,c.tabIndex=100*c.question.ordinal+c.question.sub_ordinal,c.question.updateRequired=c.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("datetime",["$compile","appFunc","$sce",function(a,b,c){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/datetime.html",link:function(a,d,e,f){a.htmlText=c.trustAsHtml(a.question.question_text),a.refreshDays=function(){if(!a.month||a.month.index<1)return a.days=[],a.days;for(var b=new Date(2016,a.month.index,0).getDate(),c=a.days.length,d=c+1;b>=d;d++)a.days.push({id:d});for(d=b+1;c>=d;d++)a.days.pop();return a.updateRequired(),a.days},a.updateRequired=function(){return a.question.showRequired=!1,a.question.is_visible!==!0||a.question.is_required!==!0?(a.question.required=!1,!1):(a.month&&a.year&&a.day?a.question.required=!1:a.question.required=!0,a.error&&""!=a.error?(console.log("Question has error."),a.question.required=!0,!1):a.question.required)},a.update=function(){var c="",d="",e="";if(a.month&&(c=a.month.index),a.day&&(d=a.day.id),a.year&&(e=a.year),a.prevValue.month!==c||a.prevValue.year!==a.year||a.prevValue.day!==d||angular.isDefined(a.question.hasSaveError)!==!1&&0!=a.question.hasSaveError){if(a.prevValue.month=c,a.prevValue.year=a.year,a.prevValue.day=d,a.question.edited=!0,""===c&&""===e&&""===d)return void b.deleteUserResponse(a.question,a).then(function(){a.updateRequired()},function(){a.updateRequired()});if(a.updateRequired()!==!0){var f={month:c,year:a.year,day:d},g={user_response:{answer_id:0,question_id:a.question.id,user_response:f}};b.updateUserResponse(a.question,g,a).then(function(){a.updateRequired()},function(){a.updateRequired()})}}},a.months=[{index:1,title:"January"},{index:2,title:"February"},{index:3,title:"March"},{index:4,title:"April"},{index:5,title:"May"},{index:6,title:"June"},{index:7,title:"July"},{index:8,title:"August"},{index:9,title:"September"},{index:10,title:"October"},{index:11,title:"November"},{index:12,title:"December"}],a.years=[],a.days=[];for(var g=1930,h=2004,i=g;h>i;i++)a.years.push(i);var j=a.question.user_response.user_response;a.prevValue={month:"",year:"",day:""},j&&(j.month&&(a.month=a.months[j.month-1],a.prevValue.month=j.month),a.refreshDays(),j.day&&(a.day=a.days[j.day-1],a.prevValue.day=j.day),j.year&&(a.year=a.years[j.year-g],a.prevValue.year=j.year)),a.updateRequired(),a.question.edited=!1,a.tabIndex=100*a.question.ordinal+a.question.sub_ordinal,a.question.updateRequired=a.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("dropdownSchool",["$compile","School","appFunc","$sce",function(a,b,c,d){return{restrict:"AEC",scope:{question:"=",schools:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/dropdown_school.html",link:function(a,b,e,f){a.htmlText=d.trustAsHtml(a.question.question_text);var g=a.question.user_response.user_response;a.schools=angular.copy(a.schools),g&&(a.schoolName=g.school,a["class"]=_.find(a.schools[a.schoolName],function(b){return b.id===a.question.user_response.selected_id})),a.updateRequired=function(){return a.question.showRequired=!1,a.question.edited=!0,a.question.is_visible!==!0||a.question.is_required!==!0?(a.question.required=!1,!1):(a.schoolName&&a["class"]?a.question.required=!1:a.question.required=!0,a.error&&""!=a.error?(console.log("Question has error."),a.question.required=!0,!1):a.question.required)},a.update=function(){if(a.schoolName||a["class"]){if(a.updateRequired()===!0)return;var b={school:a.schoolName},d={user_response:{answer_id:a["class"].id,question_id:a.question.id,user_response:b}};c.updateUserResponse(a.question,d,a).then(function(){a.updateRequired()},function(){a.updateRequired()})}else c.deleteUserResponse(a.question,a)},a.updateRequired(),a.question.edited=!1,a.tabIndex=100*a.question.ordinal+a.question.sub_ordinal,a.question.updateRequired=a.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("careerOccupation",["$compile","appFunc","$sce","$q",function(a,b,c,d){return{restrict:"AEC",scope:{question:"=",careers:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/career_occupation.html",link:function(a,e,f,g){a.htmlText=c.trustAsHtml(a.question.question_text);var h=a.question.user_response.user_response;if(a.careers=angular.copy(a.careers),h){a.career=_.find(a.careers,function(a){return a.id===h.career_id}),a.career&&(a.career.selected=!0);for(var i=0;i<h.occupations.length;i++){var j=_.find(a.career.occupations,function(a){return a.id===h.occupations[i]});"undefined"!=typeof j&&(j.selected=!0)}}a.selectCareer=function(b){a.update(b).then(function(c){1==c.success&&(a.career=b)})},a.selectOccupation=function(b){b.selected=!b.selected,a.update(a.career).then(function(a){1!=a.success&&(b.selected=!b.selected)},function(a){b.selected=!b.selected})},a.updateRequired=function(b){if(a.question.showRequired=!1,a.question.is_visible!==!0||a.question.is_required!==!0)return a.question.required=!1,!1;if(!b)return a.question.required=!0,!0;var c=[];return _.each(b.occupations,function(a){1==a.selected&&c.push(a.id)}),0==c.length?a.question.required=!0:a.question.required=!1,a.error&&""!=a.error?(console.log("Question has error."),a.question.required=!0,!1):a.question.required},a.update=function(c){a.question.edited=!0;var e=[],f=d.defer();if(_.each(c.occupations,function(a){1==a.selected&&e.push(a.id)}),!c&&0==e.length)return b.deleteUserResponse(a.question,a);if(a.updateRequired(c)===!0)return f.resolve({success:!0}),f.promise;var g={career_id:c.id,occupations:e},h={user_response:{answer_id:0,question_id:a.question.id,user_response:g}};return b.updateUserResponse(a.question,h,c.occupations)},a.updateRequired(a.career),a.question.edited=!1,a.tabIndex=100*a.question.ordinal+a.question.sub_ordinal,a.question.updateRequired=a.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("racial",["appFunc","$sce",function(a,b){return{restrict:"AEC",scope:{question:"=",racials:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/racial.html",link:function(c,d,e,f){c.htmlText=b.trustAsHtml(c.question.question_text);var g=c.question.user_response.user_response;c.racials=angular.copy(c.racials);var h=700;if(g)for(var i=0;i<g.rgroups.length;i++){var j=_.find(c.racials,function(a){return a.id===g.rgroups[i]});"undefined"!=typeof j&&(j.selected=!0)}c.updateRequired=function(){c.question.showRequired=!1;var a=[];return _.each(c.racials,function(b){1==b.selected&&a.push(b.id)}),c.question.is_visible!==!0||c.question.is_required!==!0?(c.question.required=!1,!1):(0==a.length?c.question.required=!0:c.question.required=!1,c.error&&""!=c.error?(console.log("Question has error."),c.question.required=!0,!1):c.question.required)},c.update=function(b){if(c.question.edited=!0,null===b)return void(c.error="Error");b&&(b.selected=!b.selected);var d=[];if(_.each(c.racials,function(a){b&&(b.ordinal===h&&a.ordinal!==h&&(a.selected=!1),b.ordinal!==h&&a.ordinal===h&&(a.selected=!1)),1==a.selected&&d.push(a.id)}),0==d.length)return void a.deleteUserResponse(c.question,c).then(function(a){1!=a.success&&(b.selected=!b.selected),c.updateRequired()},function(a){c.updateRequired()});if(c.updateRequired()!==!0){var e={rgroups:d},f={user_response:{answer_id:0,question_id:c.question.id,user_response:e}};a.updateUserResponse(c.question,f,c,c.racials).then(function(a){1!=a.success&&(b.selected=!b.selected),c.updateRequired()},function(a){c.updateRequired()})}},c.updateRequired(),c.question.edited=!1,c.tabIndex=100*c.question.ordinal+c.question.sub_ordinal,c.question.updateRequired=c.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("career",["appFunc","$sce",function(a,b){return{restrict:"AEC",scope:{question:"=",careersOnly:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/career.html",link:function(c,d,e,f){c.htmlText=b.trustAsHtml(c.question.question_text);var g=c.question.user_response.user_response;if(c.careersOnly=angular.copy(c.careersOnly),g)for(var h=0;h<g.career_ids.length;h++){var i=_.find(c.careersOnly,function(a){return a.id===g.career_ids[h]});"undefined"!=typeof i&&(i.selected=!0)}c.updateRequired=function(){if(c.question.showRequired=!1,c.question.is_visible!==!0||c.question.is_required!==!0)return c.question.required=!1,!1;var a=[];return _.each(c.careersOnly,function(b){1==b.selected&&a.push(b.id)}),0==a.length?c.question.required=!0:c.question.required=!1,c.error&&""!=c.error?(console.log("Question has error."),c.question.required=!0,!1):c.question.required},c.update=function(b){c.question.edited=!0,b&&(b.selected=!b.selected);var d=[];if(_.each(c.careersOnly,function(a){1==a.selected&&d.push(a.id)}),0==d.length)return void a.deleteUserResponse(c.question,c).then(function(a){1!=a.success&&(b.selected=!b.selected),c.updateRequired()},function(a){c.updateRequired()});if(c.updateRequired()!==!0){var d=[];_.each(c.careersOnly,function(a){1==a.selected&&d.push(a.id)});var e={career_ids:d},f={user_response:{answer_id:0,question_id:c.question.id,user_response:e}};a.updateUserResponse(c.question,f,c,c.careers_only).then(function(a){1!=a.success&&(b.selected=!b.selected),c.updateRequired()},function(a){c.updateRequired()})}},c.updateRequired(),c.question.edited=!1,c.tabIndex=100*c.question.ordinal+c.question.sub_ordinal,c.question.updateRequired=c.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("academic",["appFunc","$sce",function(a,b){return{restrict:"AEC",scope:{question:"=",academics:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/academic.html",link:function(c,d,e,f){c.htmlText=b.trustAsHtml(c.question.question_text);var g=c.question.user_response.user_response;if(c.academics=angular.copy(c.academics),g)for(var h=0;h<g.afields.length;h++){var i=_.find(c.academics,function(a){return a.id===g.afields[h]});"undefined"!=typeof i&&(i.selected=!0)}c.updateRequired=function(){if(c.question.showRequired=!1,c.question.is_visible!==!0||c.question.is_required!==!0)return c.question.required=!1,!1;var a=[];return _.each(c.academics,function(b){1==b.selected&&a.push(b.id)}),0==a.length?c.question.required=!0:c.question.required=!1,c.error&&""!=c.error?(console.log("Question has error."),c.question.required=!0,!1):c.question.required},c.update=function(b){c.question.edited=!0,b&&(b.selected=!b.selected);var d=[];if(_.each(c.academics,function(a){1==a.selected&&d.push(a.id)}),0==d.length)return void a.deleteUserResponse(c.question,c).then(function(a){1!=a.success&&(b.selected=!b.selected),c.updateRequired()},function(a){c.updateRequired()});if(c.updateRequired()!==!0){var d=[];_.each(c.academics,function(a){1==a.selected&&d.push(a.id)});var e={afields:d},f={user_response:{answer_id:0,question_id:c.question.id,user_response:e}};a.updateUserResponse(c.question,f,c,c.academics).then(function(a){1!=a.success&&(b.selected=!b.selected),c.updateRequired()},function(a){c.updateRequired()})}},c.updateRequired(),c.question.edited=!1,c.tabIndex=100*c.question.ordinal+c.question.sub_ordinal,c.question.updateRequired=c.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("noprefToggle",["appFunc","$sce",function(a,b){return{restrict:"AEC",scope:{question:"=",answers:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/nopref_toggle.html",link:function(c,d,e,f){c.htmlText=b.trustAsHtml(c.question.question_text);var g=c.question.user_response.user_response;c.answers=c.question.answers;var h=0;if(g){for(var i=0;i<g.answer_ids.length;i++){var j=_.find(c.answers,function(a){return a.id===g.answer_ids[i]});"undefined"!=typeof j&&(j.selected=!0)}h=c.answers[c.answers.length-1].ordinal}c.updateRequired=function(){c.question.showRequired=!1;var a=[];return _.each(c.answers,function(b){1==b.selected&&a.push(b.id)}),c.question.is_visible!==!0||c.question.is_required!==!0?(c.question.required=!1,!1):(0==a.length?c.question.required=!0:c.question.required=!1,c.error&&""!=c.error?(console.log("Question has error."),c.question.required=!0,!1):c.question.required)},c.update=function(b){if(c.question.edited=!0,null===b)return void(c.error="Error");b&&(b.selected=!b.selected);var d=[];if(_.each(c.answers,function(a){b&&(b.ordinal===h&&a.ordinal!==h&&(a.selected=!1),b.ordinal!==h&&a.ordinal===h&&(a.selected=!1)),1==a.selected&&d.push(a.id)}),0==d.length)return void a.deleteUserResponse(c.question,c).then(function(a){1!=a.success&&(b.selected=!b.selected),c.updateRequired()},function(a){c.updateRequired()});if(c.updateRequired()!==!0){var e={answer_ids:d},f={user_response:{answer_id:0,question_id:c.question.id,user_response:e}};a.updateUserResponse(c.question,f,c,c.answers).then(function(a){1!=a.success&&(b.selected=!b.selected),c.updateRequired()},function(a){c.updateRequired()})}},c.updateRequired(),c.question.edited=!1,c.tabIndex=100*c.question.ordinal+c.question.sub_ordinal,c.question.updateRequired=c.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("dropdownEmployer",["$compile","Employer","appFunc","$sce",function(a,b,c,d){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/dropdown_employer.html",link:function(a,e,f,g){a.htmlText=d.trustAsHtml(a.question.question_text),a.question.user_response&&a.question.user_response.user_response&&(a.employer={id:a.question.user_response.selected_id,name:a.question.user_response.user_response}),a.updateRequired=function(){return a.question.showRequired=!1,a.question.is_visible!==!0||a.question.is_required!==!0?(a.question.required=!1,!1):(a.question.user_response.user_response||(a.question.required=!0),a.employer?a.question.required=!1:a.question.required=!0,a.error&&""!=a.error?(console.log("Question has error."),a.question.required=!0,!1):a.question.required)},a.getEmployers=function(a){return b.query({filter:a}).$promise.then(function(a){return 0==a.length?[{id:0,name:"Not Listed"}]:a})},a.onSelect=function(b,c,d){a.employer=b,a.question.edited=!0,a.updateRequired()===!0},a.update=function(){if(a.updateRequired()!==!0){var b=0;a.employer?b=a.employer.id:a.updateRequired();var d={user_response:{answer_id:b,question_id:a.question.id,user_response:a.employer.name}};console.log(d),c.updateUserResponse(a.question,d,a).then(function(){a.updateRequired()},function(){a.updateRequired()})}},a.clearEmployer=function(){a.employer=null},a.updateRequired(),a.question.edited=!1,a.tabIndex=100*a.question.ordinal+a.question.sub_ordinal,a.question.updateRequired=a.updateRequired}}}]);;
var forms=angular.module("imForm");forms.directive("dropdownDependence",["$compile","Employer","appFunc","$sce",function(a,b,c,d){return{restrict:"AEC",scope:{question:"=",fieldErrMsg:"=",updateUserResponse:"&"},templateUrl:"/new_platform/static/apiforms/drtvhtml/dropdown_dependence.html",link:function(a,e,f,g){a.htmlText=d.trustAsHtml(a.question.question_text),a.question.user_response&&a.question.user_response.selected_id&&(a.employer={id:a.question.user_response.selected_id,name:a.question.user_response.user_response},a.employer1=a.question.user_response.user_response,a.employer2=""),a.updateRequired=function(){return a.question.showRequired=!1,a.question.is_visible!==!0||a.question.is_required!==!0?(a.question.required=!1,!1):(!a.employer&&!a.employer2||null===a.employer.id&&!a.employer2?a.question.required=!0:a.question.required=!1,a.error&&""!=a.error?(console.log("Question has error."),a.question.required=!0,!1):a.question.required)},a.getEmployers=function(a){return b.query({filter:a}).$promise.then(function(a){return 0==a.length?[{id:null,name:"Not Listed"}]:a})},a.onSelect=function(b,c,d){a.employer=b,a.question.edited=!0,null===a.employer.id?a.question.dependence_required=!0:a.question.dependence_required=!1,a.updateRequired()===!0},a.update=function(){if(a.updateRequired()!==!0){var b=null,d="Not Listed";a.employer?(b=a.employer.id,d=a.employer.name):a.updateRequired();var e={user_response:{question_id:a.question.id,user_response:{employer1:{answer_id:b,answer:d},employer2:{answer_id:null,answer:a.employer2}}}};console.log(e),c.updateUserResponse(a.question,e,a).then(function(){a.updateRequired()},function(){a.updateRequired()})}},a.clearEmployer=function(){a.employer=null},a.updateRequired(),a.question.edited=!1,a.tabIndex=100*a.question.ordinal+a.question.sub_ordinal,a.question.updateRequired=a.updateRequired}}}]);
//# sourceMappingURL=app.min.js.map